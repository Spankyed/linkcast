!function(t){function e(o){if(a[o])return a[o].exports;var r=a[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){"use strict";var o=a(1),r=a(2),n=a(4),i=a(5),s=a(8),c=a(9),u=a(6),l=a(10),d=function(){var t={bgPage:null,edit:0,noticationIntervalTimer:0,init:function(){t.bgPage=chrome.extension.getBackgroundPage(),t._addEventListeners();var e=chrome.runtime.getManifest(),a=e.version;$(".version").html(a),t.setTheme(),c.userExist(function(e){e.flag?(t._detectSite(),c.info=e.data,i.fetchItems("#wall","html",null),s.fetchGroups(),t._activateScroll(),t._resetNotification(),c.welcomeUser(e.data.nickname),$("#group-display").html(o.getItem("defaultGroupName")),t._updateNotificationCount(),t.noticationIntervalTimer=setInterval(t._updateNotificationCount,2e3)):($('a[data-target="#settings"]').click(),$("#loader").remove(),s.groupNotSetMessage())})},_addEventListeners:function(){var e=t;$("button.register-btn").click(e.registerUser),$("button.login-btn").click(e.loginUser),$("#tab-create-group #create-group").click(s.createEditGroup),$("#edit-group-save-btn").click(s.createEditGroup),$("#join-group").click(s.joinPrivateGroup),$("#add-item button").click(i.addItem),$("#default-group").click(function(){s.makeGroupDefault("#settings #groups-dd")}),$(document).on("click",".favourite",i.makeFavourite),$(document).on("click",".delete-item",i.deleteItem),$(document).on("click",".comments-item",l.showComments),$(document).on("click",".item-link",i.itemClicked),$(document).on("click",".forward-item",i.itemForward),$("#settings #groups-dd").on("change",s.groupDDChanged),$(document).on("keyup",".comment-input",l.sendComment.bind(void 0)),$("#wall #groups-dd").on("change",function(){s.makeGroupDefault("#wall #groups-dd"),i.fetchItems("#wall","html",null)}),$('a[data-toggle="tab"]').on("shown.bs.tab",e._tabChanged),$("#edit-group").click(s.editGroup),$("#edit-group-cancel-btn").click(function(){$("#edit-group").removeClass("hide"),$(".editgroup-block").addClass("hide")}),$("#settings").on("click","#logout",e._logout),$(document).on("click","#group-visibility .radio",function(t){var e=$(t.target).val();"0"==e?$(".tab-pane.active #group-private").removeClass("hide"):$(".tab-pane.active #group-private").addClass("hide")}),$("#tab-manage-group").on("click",".remove-user",s.removeUserFromGroup),$("#tab-manage-group").on("click",".user-item .radio",c.changePublicRights),$("#tab-public-group").on("click",".group-join",s.joinPublicGroup),$("#tab-public-group").on("click",".group-leave",s.leaveGroup),$("#tab-customize #sound-setting .radio").click(function(t){o.setItem("sound",$(t.target).val())}),$("#tab-customize #theme-setting .radio").click(function(t){o.setItem("theme",$(t.target).val()),e.setTheme()}),$("#tab-customize #rich-notification .radio").click(function(t){o.setItem("richNotification",$(t.target).val())}),$("#tab-customize #sound-setting .radio").click(function(t){o.setItem("sound",$(t.target).val())})},setTheme:function(){var t=o.getItem("theme");null!=t&&($("#theme").attr("href","css/bs."+t+".css"),$("body").removeAttr("class").addClass(t))},_logout:function(){o.clearAll(),o.setItem("loggedOut",!0),$(".status").html(""),$(".step1").show(),$("#groups-dd").html("<option value='0'>Select</option>"),$("#group-display").html("")},_tabChanged:function(e){e.preventDefault();var a=$(e.target).data("target");i.page=1,$("ul.chat").html('<div id="loader" class="cssload-aim"></div>'),c.userExist(function(e){if(e.flag){var r=["#wall","#updates","#comments","#user-links","#favourites"];if(r.indexOf(a)!==-1)i.fetchItems(a,"html",null);else if("#about"===a)t._getRandomQuote();else if("#settings"===a){s.fetchGroups();var n=o.getItem("theme"),c=o.getItem("sound"),u=o.getItem("richNotification");null!==n&&$("#tab-customize #theme-setting .radio[value='"+n+"']").attr("checked","checked"),null!==u&&$("#tab-customize #rich-notification .radio[value='"+u+"']").attr("checked","checked"),null!==c&&$("#tab-customize #sound-setting .radio[value='"+c+"']").attr("checked","checked")}else"#add-item"===a?s.fetchGroups():"#tab-public-group"===a?s.getAllPublicGroups():"#tab-join-public-group"===a&&s.getAllPublicGroups()}else s.groupNotSetMessage()})},_detectSite:function(){chrome.tabs.query({currentWindow:!0,active:!0},function(e){var a={action:"get-meta"};t.bgPage.retrieveSiteMeta(a,function(t){t&&t.url&&($("#item-name").val(t.title),$("#item-url").val(t.url),$("#item-thumb").val(t.thumbUrl))})})},_resetNotification:function(){u.getUserId(function(e){var a=o.getItem("defaultGroup");if(null!==a){var i={group:a,chrome_id:e,action:"resetNotification"},s=n.getDataString(i);r.get(s),t.bgPage.updateNotification(0)}})},_updateNotificationCount:function(){t.bgPage.getNotificationCount(function(e){parseInt(e.wallCount)>0&&($("#wall-count").text("("+e.wallCount+")"),i.fetchItems("#wall","prepend",e.wallCount,null),t._resetNotification()),parseInt(e.updateCount)>0&&($("#update-count").text("("+e.updateCount+")"),i.fetchItems("#updates","prepend",e.updateCount,null),t._resetNotification()),parseInt(e.commentCount)>0&&($("#comment-count").text("("+e.commentCount+")"),i.fetchItems("#updates","prepend",e.commentCount,null),t._resetNotification())})},_activateScroll:function(){var t=$("#wall .panel-body, #updates .panel-body, #favourites .panel-body, #user-links .panel-body");t.scroll(function(t){var e=$(t.target).innerHeight(),a=$(t.target).scrollTop(),o=$(t.target)[0].scrollHeight,r=!0,n=$("#myTab .active a").data("target");return a+e==o&&r===!0&&(i.page++,i.page<=i.totalPages&&i.fetchItems(n,"append",null,function(t){r=!1})),t.stopPropagation(),t.preventDefault(),!1})},registerUser:function(){u.getUserId(function(e){var a={chrome_id:e,nickname:$("#nickname").val(),password:$("#password").val(),action:"registerUser"};u.register(a,function(e){c.welcomeUser(a.nickname),c.afterLogin(e),t.bgPage.updateVersion()})})},loginUser:function(){u.getUserId(function(e){var a={chrome_id:e,nickname:$("#nickname").val(),password:$("#password").val(),action:"loginUser"};u.login(a,function(e){c.welcomeUser(a.nickname),c.afterLogin(e),t.bgPage.updateVersion()})})},_getRandomQuote:function(){var t={action:"getQuote"},e=n.getDataString(t);r.get(e,function(t){$("#random_quote").html("<p class='ext-center'>"+t.quote+"<br/>&dash; "+t.author+" &dash;</p>")})}};return{init:t.init}},g=d();$(document).ready(g.init)},function(t,e){"use strict";t.exports=new function(){this.getItem=function(t){return localStorage.getItem(t)},this.setItem=function(t,e){localStorage.setItem(t,e)},this.removeItem=function(t){localStorage.removeItem(t)},this.clearAll=function(){localStorage.clear()}}},function(t,e,a){"use strict";var o=a(1),r=a(3),n=new function(){var t=this;this._sendRequest=function(t,e,a){$.ajax({url:r.getEndpoint(),type:t,data:e,timeout:4e3,dataType:"json",success:a,error:function(t){200!=t.status&&$(".chat").html("Hey "+o.getItem("nickname")+", wait, server is busy :( Please try after sometime!")}})},this.post=function(e,a){t._sendRequest("POST",e,a)},this.get=function(e,a){t._sendRequest("GET",e,a)}};t.exports=n},function(t,e){"use strict";t.exports=new function(){var t=this;this.devmode=!0,this.dev_url="http://localhost:8000",this.prod_url="http://playground.ajaxtown.com/youtube_chrome_backend/index.php",this.getEndpoint=function(){return console.log(t.dev_url),t.devmode?t.dev_url:t.prod_url}}},function(t,e){"use strict";t.exports=new function(){var t=this;this.basePropertyOf=function(t){return function(e){return null==t?void 0:t[e]}},this.escape=function(e){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},o=t.basePropertyOf(a),r=/[&<>"']/g;return e.replace(r,o)},this.unescape=function(e){var a={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},o=t.basePropertyOf(a),r=/&(?:amp|lt|gt|quot|#39);/g;return e.replace(r,o)},this.getRandomToken=function(){var t=new Uint8Array(32);crypto.getRandomValues(t);for(var e="",a=0;a<t.length;++a)e+=t[a].toString(16);return e},this.getDataString=function(t){var e="1=1";for(var a in t)e+="&"+a+"="+t[a];return e},this.lazyLoadImages=function(t){t.each(function(){var t=$(this);$.ajax({url:t.data("src"),type:"HEAD",timeout:1200,success:function(){t.hide().attr("src",t.data("src")).fadeIn(1e3).removeClass("lazy").removeAttr("data-src")}})})}}},function(t,e,a){"use strict";var o=a(2),r=a(1),n=a(6),i=a(4),s=a(7);t.exports=new function(){var t=this;this.page=1,this.totalPages=0,this.fetchItems=function(e,a,s,c){var u=r.getItem("defaultGroup");u&&n.getUserId(function(n){var l=r.getItem("uid"),d={count:s,handle:e.replace("#",""),page:t.page,chrome_id:n,group:u,action:"readTracks"},g=i.getDataString(d);o.get(g,function(o){$("#loader").remove();var r=$(e+" .item").length,n="";t.totalPages=o.pages,0===o.rows.length&&(n="Nothing found."),o.rows.forEach(function(t,a){var o=$("#item-template").clone(),s=null===t.comments?"":t.comments,c=t.thumbnail;""!=t.thumbnail&&null!=t.thumbnail||(c="assets/weed.jpg");var u="#wall"==e?"":"["+t.name+"]",d="1"==t.favourite?"glyphicon-star":"glyphicon-star-empty",g=t.uid==l?"Delete":"",t=o.html().replace("{NICKNAME}",i.escape(t.nickname)).replace("{SRNO}",++r).replace("{STAR}",d).replace("{THUMB}",c).replace("{ITEM_ID}",t.id).replace("{USER_ID}",t.uid).replace("{TITLE}",i.escape(t.title)).replace("{URL}",i.escape(t.url)).replace("{COMMENTS}",s).replace("{GROUP_NAME}",i.escape(u)).replace("{GROUP_ID}",u).replace("{DELETE}",g).replace("{COMMENTS_COUNT}",t.comments_count).replace("{TIMES_CLICKED}",t.times_clicked).replace("{CREATED_AT}",moment(t.created_at).add(moment().utcOffset(),"minutes").fromNow());n+=t}),"append"===a?$(e+" ul.chat").append(n):"prepend"===a?$(e+" ul.chat").prepend(n):"html"===a&&$(e+" ul.chat").html(n),i.lazyLoadImages($(e+" ul.chat .lazy")),"function"==typeof c&&c(n)})})},this.addItem=function(){var t=$("#item-name").val(),e=$("#item-url").val(),a=$("#item-thumb").val(),c=$("#item-comments").val(),u=$("#add-item #groups-dd").val(),l=r.getItem("defaultGroup"),d=1;""==e&&(s.show("Enter a valid URL","Error"),d=0),1===d&&""==t&&(s.show("Enter a Title","Error"),d=0),1===d&&(u&&"0"!=u?n.getUserId(function(r){var n={thumbnail:a,comments:c,title:t,url:e,group:u,chrome_id:r,action:"insertTrack"},d=i.getDataString(n);o.post(d,function(t){t.flag?(u==l?$('a[data-target="#wall"]').click():$('a[data-target="#updates"]').click(),$("#add-item input").val("")):s.show(t.msg,"Sorry")})}):s.show("Select a group as default from Settings","Error"))},this.itemClicked=function(t){$handle=$(t.target).parents(".item");var e=$handle.data("id");n.getUserId(function(t){var a={chrome_id:t,action:"itemClicked",item_id:e},o=main.getDataString(a);main.bgPage.sendClickedStat(o)})},this.itemForward=function(t){var e=$(t.target).parents(".item"),a=e.find(".item-link").attr("href"),o=e.find(".item-link").text();$('a[data-target="#add-item"]').click(),$("#add-item #item-name").val(o),$("#add-item #item-url").val(a)},this.deleteItem=function(t){var e=$(t.target).parents(".item"),a=e.data("id");n.getUserId(function(t){var r={item_id:a,chrome_id:t,action:"deleteItem"},n=i.getDataString(r);o.post(n,function(t){t.flag&&e.remove()})})},this.makeFavourite=function(t){var e=$(t.target),a=e.parents(".item").data("id");n.getUserId(function(t){var r="addToFavourite",n="glyphicon-star";e.hasClass("glyphicon-star")&&(r="removeFromFavourite",n="glyphicon-star-empty");var s={chrome_id:t,item_id:a,action:r},c=i.getDataString(s);o.post(c,function(t){$('.item[data-id="'+a+'"] .favourite').removeClass("glyphicon-star glyphicon-star-empty").addClass(n)})})}}},function(t,e,a){"use strict";var o=a(2),r=a(1),n=a(7),i=a(4);t.exports=new function(){this.login=function(t,e){if(t.nickname.length>0&&t.password.length>0){var a=i.getDataString(t);o.post(a,function(a){a.flag?(r.setItem("nickname",t.nickname),r.setItem("loggedIn",!0),r.setItem("chrome_id",a.chrome_id),chrome.storage.sync.set({userid:a.chrome_id}),"function"==typeof e&&e(a)):n.show(a.msg,"Error")})}},this.register=function(t,e){if(t.nickname.length>0&&t.password.length>0){var a=i.getDataString(t);o.post(a,function(a){a.flag?(r.setItem("nickname",t.nickname),r.setItem("loggedIn",!0),r.setItem("chrome_id",a.chrome_id),"function"==typeof e&&e(a)):n.show(a.msg,"Error")})}},this.getUserId=function(t){var e=r.getItem("chrome_id");if(null!=e)t(e);else{var a=i.getRandomToken();chrome.storage.sync.set({userid:a},function(){t(a)})}}}},function(t,e){"use strict";t.exports={show:function(t,e){$("#msg").html("<strong>"+e+"</strong>: "+t).removeClass("hide"),setTimeout(function(){$("#msg").addClass("hide")},3e3)}}},function(t,e,a){"use strict";var o=a(6),r=a(4),n=a(2),i=a(7),s=a(1);t.exports=new function(){var t=this;this.fetchGroups=function(){o.getUserId(function(e){var a={chrome_id:e,action:"fetchUserGroups"},o=r.getDataString(a);n.get(o,function(e){var a=s.getItem("defaultGroup"),o="<option value='0'>Select</option>";e.forEach(function(t){var e="",r=!1;t.admin===t.uid&&(e="(admin)",r=!0);var n=a===t.gid?" selected ":"";o+='<option\n                                    data-desc="'+t.desc+'"\n                                    is_public="'+t.is_public+'"\n                                    group_rights="'+t.group_rights+'"\n                                    admin-id="'+t.admin+'"\n                                    name="'+t.gname+'"\n                                    admin="'+r+'"\n                                    '+n+'\n                                    value="'+t.gid+'"\n                                >\n                                    '+t.gname+"\n                                    "+e+"\n                                </option>"}),$("#settings #groups-dd,#add-item #groups-dd,#wall #groups-dd").html(o),t.groupDDChanged()})})},this.createEditGroup=function(e){var a=$(e.target).data("action");o.getUserId(function(e){var o=$("#settings .tab-pane.active #group_name").val(),s=$("#settings .tab-pane.active #group_desc").val(),c=$("#settings .tab-pane.active #group-visibility .radio:checked").val(),u={is_public:c,action:"createEditGroup",chrome_id:e,desc:s,mode:a,name:o,group_rights:$("#settings .tab-pane.active #group-rights .radio:checked").val()};"edit"==a&&(u.gid=$("#settings #groups-dd option:selected").val()),"0"==c&&(u.password=$("#settings .tab-pane.active #group-private #group-password").val());var l=r.getDataString(u);""==o?i.show("Please enter a groupname. Noob!","Error"):""==s?i.show("Please enter a group description!","Error"):n.post(l,function(e){e.flag?($("#settings .tab-pane.active #group_name").val(""),i.show(e.msg,"Success"),t.fetchGroups(),$("#edit-group-cancel-btn").click()):i.show(e.msg,"Error")})})},this.leaveGroup=function(t){var e=$(t.target),a=e.parents("tr").data("gid");o.getUserId(function(t){var o={action:"leaveGroup",chrome_id:t,group_id:a},s=r.getDataString(o);n.post(s,function(t){t.flag?(e.removeClass("group-leave red").addClass("group-join green").html("Join"),i.show(t.msg,"Success")):i.show(t.msg,"Error")})})},this.joinPublicGroup=function(t){var e=$(t.target),a=e.parents("tr").data("gid");o.getUserId(function(t){var o={action:"joinPublicGroup",chrome_id:t,group_id:a},s=r.getDataString(o);n.post(s,function(t){t.flag?(e.removeClass("group-join green").addClass("group-leave red").html("Leave"),i.show(t.msg,"Success")):i.show(t.msg,"Error")})})},this.joinPrivateGroup=function(){var e=$("#tab-private-group #group_name").val(),a=$("#tab-private-group #group_password").val();""!=e?o.getUserId(function(o){var s={action:"joinPrivateGroup",chrome_id:o,group_name:e,group_password:a},c=r.getDataString(s);n.post(c,function(e){e.flag?($("#tab-private-group #group_name, #tab-private-group #group_password").val(""),t.fetchGroups(),i.show(e.msg,"Success")):i.show(e.msg,"Error")})}):i.show("Enter a groupname. Noob!","Error")},this.makeGroupDefault=function(t){var e=$(t).val();if("0"!=e){var a=$(t).find("option:selected").text();s.setItem("defaultGroup",e),s.setItem("defaultGroupName",a),i.show("Default group set to "+a,"Success"),$("#group-display").html(s.getItem("defaultGroupName"))}else i.show("Select a group","Error")},this.groupDDChanged=function(){var t=$("#settings #groups-dd").val();$(".editgroup-block").addClass("hide");var e=$("#settings #groups-dd option:selected").attr("admin"),a=$("#settings #groups-dd option:selected").attr("admin-id");"true"==e?($("#edit-group").removeClass("hide"),$("#rename-group-input").val($("#settings #groups-dd option:selected").attr("name"))):($("#edit-group").addClass("hide"),$("#rename-group-input").val("")),$("#group-users-block").addClass("hide"),$("#group-users-table tbody").html(""),"0"!=t&&"true"==e&&o.getUserId(function(e){var o={group:t,chrome_id:e,action:"getGroupUsers"},i=r.getDataString(o);n.get(i,function(t){var e="";t.forEach(function(t,o){var r=$("#users-template").clone().find("tbody"),n=t.id==a?"":"remove";e+=r.html().replace("{NICKNAME}",t.nickname).replace("{USER_ID}",t.id).replace("{REMOVE}",n).replace("{"+t.group_rights+"}","checked").replace(new RegExp("{i}","g"),o)}),$("#group-users-table tbody").html(e),$("#group-users-block").removeClass("hide")})})},this.removeUserFromGroup=function(t){var e=$(t.target).parents(".user-item"),a=e.data("id"),s=$("#settings #groups-dd").val();o.getUserId(function(t){var o={user_id:a,group_id:s,action:"removeUserFromGroup",chrome_id:t},c=r.getDataString(o);n.post(c,function(t){t.flag?(e.remove(),i.show(t.msg,"Success")):i.show(t.msg,"Error")})})},this.groupNotSetMessage=function(){null===s.getItem("defaultGroup")&&($("#wall ul.chat").html("- Login/register to get started<br>- Create a new group or select a group as default<br>- Items from Default group will be displayed here"),$("#updates ul.chat").html("- Login/register to get started<br>- Updates from Non-Default groups will be displayed here."))},this.getAllPublicGroups=function(){o.getUserId(function(t){var e={chrome_id:t,action:"getAllPublicGroups"},a=r.getDataString(e);n.post(a,function(t){var e="";t.forEach(function(t){var a="1"==t.status?"<a href='#' class='red group-leave'>Leave</a>":"<a href='#' class='green group-join'>Join</a>";e+="<tr data-gid="+t.id+"> \t                                <td><strong>"+t.name+"</strong> <br/>"+t.desc+".</td> \t                                <td>"+t.group_rights+"</td> \t                                <td>"+t.total+"</td> \t                                <td>"+a+"</td> \t                            </tr>"}),$("#tab-public-group tbody").html(e)})})},this.editGroup=function(t){$(t.target).addClass("hide"),$(".editgroup-block").removeClass("hide");var e=$("#tab-create-group").clone();e.find("#create-group").remove(),$("div.editgroup-block #editgroup-wrapper").html(e.html()).removeClass("hide"),$handle=$("#editgroup-wrapper"),$option=$("#tab-manage-group #groups-dd option:selected"),$handle.find("#group_name").val($option.text().replace("(admin)","").trim()),$handle.find("#group_desc").val($option.data("desc")),$("#tab-manage-group #group-visibility .radio[value='"+$option.attr("is_public")+"']").attr("checked","checked"),console.log($option.attr("group_rights")),$("#tab-manage-group #group-rights .radio[value='"+$option.attr("group_rights")+"']").attr("checked","checked")},this._editGroupSave=function(){var t=$("#rename-group-input").val(),e=$("#settings #groups-dd option:selected").val();o.getUserId(function(a){n.post("name="+t+"&group_id="+e+"&chrome_id="+a+"&action=editGroupSave",function(a){a.flag?($(".editgroup-block").addClass("hide"),i.show(a.msg,"Success"),$("#edit-group").removeClass("hide"),$("#groups-dd option[value='"+e+"']").html(t+"(admin)"),s.getItem("defaultGroup")==e&&(s.setItem("defaultGroupName",t+"(admin)"),$("#group-display").html(t+"(admin)"))):i.show(a.msg,"Error")})})}}},function(t,e,a){"use strict";var o=a(7),r=a(6),n=a(1),i=a(2),s=a(8),c=a(4),u=new function(){this.info={},this.welcomeUser=function(t){var e='<a href="#" id="logout">Logout</a>';$(".status").html("Connected as <strong>"+t+"</strong>, "+e),$("#edit-uname-input").val(t),$(".step1").hide()},this.afterLogin=function(t){t.defaultGroup&&(n.setItem("defaultGroup",t.defaultGroup),n.setItem("defaultGroupName",t.defaultGroupName),n.setItem("uid",t.uid),$("#group-display").html(t.defaultGroupName),s.fetchGroups())},this._updateUsername=function(t){var e=$(t.target).val();""!=name&&r.getUserId(function(t){var a={nickname:e,action:"updateUsername",chrome_id:t},r=c.getDataString(a);i.get(r,function(t){t.flag?o.show(t.msg,"Success"):o.show(t.msg,"Error")})})},this.changePublicRights=function(t){var e=$(t.target).parents(".user-item"),a=e.data("id"),n=$("#settings #groups-dd").val(),s=$(t.target).val();r.getUserId(function(t){var e={user_id:a,group_id:n,action:"changePublicRights",chrome_id:t,group_rights:s},r=c.getDataString(e);i.post(r,function(t){t.flag?o.show(t.msg,"Success"):o.show(t.msg,"Error")})})},this.userExist=function(t){var e={flag:0};null===n.getItem("loggedIn")?t(e):r.getUserId(function(e){var a={chrome_id:e,action:"fetchUserInfo"},o=c.getDataString(a);i.get(o,function(e){t(e)})})}};t.exports=u},function(t,e,a){"use strict";var o=a(6),r=a(2),n=a(9),i=a(4);t.exports=new function(){var t=this;this.commentsPage=1,this.totalCommentsPages=0,this.sendComment=function(t){var e=$(t.target).parents(".item"),a=e.find(".comments-section .comments"),s=e.data("id"),c=e.find(".comment-input").val().trim();13==t.keyCode&&c.length>0&&(e.find(".comment-input").val(""),o.getUserId(function(t){var e={item_id:s,comment:c,chrome_id:t,action:"insertComment"};r.post(i.getDataString(e),function(t){if(1==t.flag){var e=$("#comment-template").clone(),o=e.html().replace("{COMMENT_ID}",t.id).replace("{USER_NAME}",n.info.nickname).replace("{USER_COMMENT}",i.escape(c)).replace("{COLOR}",n.info.color).replace("{COMMENT_DATE}","now");a.prepend(o)}})}))},this.showComments=function(e){var a=$(e.target).parents(".item"),o=a.data("id"),r=a.find(".comments-section .comments");r.parent().toggleClass("hide"),r.html("loading..."),t.fetchComments(r,"html",null,o)},this.fetchComments=function(e,a,n,s,c){o.getUserId(function(o){var n={commentsPage:t.commentsPage,item_id:s,chrome_id:o,action:"commentsItem"},u=i.getDataString(n);r.get(u,function(o){t.totalCommentsPages=o.total;var r="";o.rows.length>0&&o.rows.forEach(function(t){var e=$("#comment-template").clone(),t=e.html().replace("{COMMENT_ID}",t.id).replace("{USER_NAME}",t.nickname).replace("{USER_COMMENT}",i.escape(t.comment)).replace("{COLOR}",t.color).replace("{COMMENT_DATE}",moment(t.created_at).add(moment().utcOffset(),"minutes").fromNow());r+=t}),"html"===a?e.html(r):"append"===a?e.append(r):"prepend"===a&&e.prepend(r),"function"==typeof c&&c(r)})})}}}]);
//# sourceMappingURL=app.entry.js.map